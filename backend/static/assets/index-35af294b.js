import{bB as _s,bC as e,r as i,bD as Et,bE as ws,bF as vs,bG as js,bH as Cs,bI as ge,bJ as Ts,bK as ks,bL as Ct,bM as Is,bN as Ls,bO as Ns,bP as As,bQ as Fs,bR as Ps,bS as Rs,bT as Es,bU as Ms,bV as Tt}from"./vendor-bdbde4de.js";import{e as Us,E as Os,M as kt,f as Bs,g as Vs,D as Mt,h as Gs,i as qs}from"./fluentui-icons-6b98e6c1.js";import{I as Z,S as v,P as $s,T as Ue,B as W,a as H,u as zs,b as m,C as Ut,D as Ge,c as Ds,d as Hs,M as Qs,e as Ks,L as Ws,f as Js,g as Re,h as Ot,i as le,j as Oe,k as It,l as Xs,m as Ys,n as Lt,o as Zs,p as en,q as tn,r as Q,s as sn}from"./fluentui-react-daad5bea.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function r(o){if(o.ep)return;o.ep=!0;const c=n(o);fetch(o.href,c)}})();const nn="_container_1eier_1",an="_chatRoot_1eier_15",on="_chatContainer_1eier_25",rn="_chatEmptyState_1eier_41",ln="_chatEmptyStateTitle_1eier_61",cn="_chatEmptyStateSubtitle_1eier_75",dn="_chatMessageStream_1eier_107",un="_chatMessageGpt_1eier_131",hn="_chatMessageGptMinWidth_1eier_145",pn="_chatInput_1eier_155",mn="_chatAnalysisPanel_1eier_181",gn="_chatSettingsSeparator_1eier_197",xn="_loadingLogo_1eier_209",fn="_commandsContainer_1eier_217",bn="_commandButton_1eier_227",f={container:nn,chatRoot:an,chatContainer:on,chatEmptyState:rn,chatEmptyStateTitle:ln,chatEmptyStateSubtitle:cn,chatMessageStream:dn,chatMessageGpt:un,chatMessageGptMinWidth:hn,chatInput:pn,chatAnalysisPanel:mn,chatSettingsSeparator:gn,loadingLogo:xn,commandsContainer:fn,commandButton:bn},Sn=".auth/me",yn=".auth/refresh",_n=".auth/logout?post_logout_redirect_uri=/";async function wn(){const t=await fetch("/auth_setup");if(!t.ok)throw new Error(`auth setup response was not ok: ${t.status}`);return await t.json()}const J=await wn(),G=J.useLogin,ue=J.requireAccessControl,vn=J.enableUnauthenticatedAccess,Nt=ue&&!vn,jn=J.msalConfig,Cn=J.loginRequest,Tn=J.tokenRequest,Bt=()=>window.location.origin+J.msalConfig.auth.redirectUri;globalThis.cachedAppServicesToken=null;const xe=()=>{const t=n=>{const r=new Date;return new Date(n.expires_on)>r};if(globalThis.cachedAppServicesToken&&t(globalThis.cachedAppServicesToken))return Promise.resolve(globalThis.cachedAppServicesToken);const s=()=>fetch(Sn).then(n=>n.ok?n.json().then(r=>r.length>0?{id_token:r[0].id_token,access_token:r[0].access_token,user_claims:r[0].user_claims.reduce((o,c)=>(o[c.typ]=c.val,o),{}),expires_on:r[0].expires_on}:null):null);return s().then(n=>n?t(n)?(globalThis.cachedAppServicesToken=n,n):fetch(yn).then(r=>r.ok?s():null):null)},kn=await xe()!=null,In=()=>{window.location.href=_n},Be=async t=>!!(t&&t.getActiveAccount()||await xe()),he=async t=>{const s=await xe();return s?Promise.resolve(s.access_token):t.acquireTokenSilent({...Tn,redirectUri:Bt()}).then(n=>n.accessToken).catch(n=>{console.log(n)})},Ee=async t=>{const s=t.getActiveAccount();if(s)return s.username;const n=await xe();return n?.user_claims?n.user_claims.preferred_username:null},Ln=async t=>{const s=t.getActiveAccount();if(s)return s.idTokenClaims;const n=await xe();if(n)return n.user_claims},je="";async function ee(t){return G&&!kn&&t?{Authorization:`Bearer ${t}`}:{}}async function Nn(){return await(await fetch(`${je}/config`,{method:"GET"})).json()}async function Ao(t,s){const n=await ee(s),r=await fetch(`${je}/ask`,{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify(t)}),o=await r.json();if(r.status>299||!r.ok)throw Error(o.error||"Unknown error");return o}async function An(t,s,n){let r=`${je}/chat`;s&&(r+="/stream");const o=await ee(n);return await fetch(r,{method:"POST",headers:{...o,"Content-Type":"application/json"},body:JSON.stringify(t)})}async function Fn(t){return await fetch("/speech",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})}).then(s=>s.status==200?s.blob():s.status==400?(console.log("Speech synthesis is not enabled."),null):(console.error("Unable to get speech synthesis."),null)).then(s=>s?URL.createObjectURL(s):null)}function Vt(t){return`${je}/content/${t}`}async function Pn(t,s){const n=await fetch("/upload",{method:"POST",headers:await ee(s),body:t});if(!n.ok)throw new Error(`Uploading files failed: ${n.statusText}`);return await n.json()}async function Rn(t,s){const n=await ee(s),r=await fetch("/delete_uploaded",{method:"POST",headers:{...n,"Content-Type":"application/json"},body:JSON.stringify({filename:t})});if(!r.ok)throw new Error(`Deleting file failed: ${r.statusText}`);return await r.json()}async function En(t){const s=await fetch("/list_uploaded",{method:"GET",headers:await ee(t)});if(!s.ok)throw new Error(`Listing files failed: ${s.statusText}`);return await s.json()}var A=(t=>(t.Hybrid="hybrid",t.Vectors="vectors",t.Text="text",t))(A||{}),V=(t=>(t.TextAndImages="textAndImages",t.Images="images",t.Texts="texts",t))(V||{}),M=(t=>(t.Embedding="embedding",t.ImageEmbedding="imageEmbedding",t.Both="both",t))(M||{});const Mn="_answerContainer_1pvw0_1",Un="_answerLogo_1pvw0_21",On="_answerText_1pvw0_29",Bn="_selected_1pvw0_67",Vn="_citationLearnMore_1pvw0_75",Gn="_citation_1pvw0_75",qn="_followupQuestionsList_1pvw0_119",$n="_followupQuestionLearnMore_1pvw0_127",zn="_followupQuestion_1pvw0_119",Dn="_supContainer_1pvw0_165",Hn="_retryButton_1pvw0_223",Qn="_loadingdots_1pvw0_267",Kn="_loading_1pvw0_267",F={answerContainer:Mn,answerLogo:Un,answerText:On,selected:Bn,citationLearnMore:Vn,citation:Gn,followupQuestionsList:qn,followupQuestionLearnMore:$n,followupQuestion:zn,supContainer:Dn,retryButton:Hn,loadingdots:Qn,loading:Kn};function Wn(t,s,n){const r=[];let o=t.trim();if(s){let l=o.length;for(let p=o.length-1;p>=0&&o[p]!=="]";p--)if(o[p]==="["){l=p;break}o=o.substring(0,l)}return{answerHtml:o.split(/\[([^\]]+)\]/g).map((l,u)=>{if(u%2===0)return l;{let p;r.indexOf(l)!==-1?p=r.indexOf(l)+1:(r.push(l),p=r.length);const S=Vt(l);return _s(e.jsx("a",{className:"supContainer",title:l,onClick:()=>n(S),children:e.jsx("sup",{children:p})}))}}).join(""),citations:r}}const Gt=()=>e.jsx(Us,{primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Answer logo"}),Jn=window.speechSynthesis||window.webkitSpeechSynthesis;let K=null;try{K=Jn}catch{console.error("SpeechSynthesis is not supported")}const Xn=function(t){if(K){const s=new SpeechSynthesisUtterance(t);return s.lang="en-US",s.volume=1,s.rate=1,s.pitch=1,s.voice=K.getVoices().filter(n=>n.lang==="en-US")[0],s}},Yn=({answer:t})=>{const[s,n]=i.useState(!1),r=c=>{if(K!=null){if(s){K.cancel(),n(!1);return}const h=Xn(c);if(!h)return;K.speak(h),h.onstart=()=>{n(!0)},h.onend=()=>{n(!1)}}},o=s?"red":"black";return e.jsx(Z,{style:{color:o},iconProps:{iconName:"Volume3"},title:"Speak answer",ariaLabel:"Speak answer",onClick:()=>r(t),disabled:!K})};let we=new Audio;const Zn=({url:t})=>{const[s,n]=i.useState(!1),r=async()=>{if(s){we.pause(),n(!1);return}if(!t){console.error("Speech output is not yet available.");return}we=new Audio(t),await we.play(),we.addEventListener("ended",()=>{n(!1)}),n(!0)},o=s?"red":"black";return e.jsx(Z,{style:{color:o},iconProps:{iconName:"Volume3"},title:"Speak answer",ariaLabel:"Speak answer",onClick:()=>r(),disabled:!t})},At=({answer:t,isSelected:s,isStreaming:n,onCitationClicked:r,onThoughtProcessClicked:o,onSupportingContentClicked:c,onFollowupQuestionClicked:h,showFollowupQuestions:l,showSpeechOutputAzure:u,showSpeechOutputBrowser:p,speechUrl:S})=>{const y=t.context?.followup_questions,_=t.message.content,w=i.useMemo(()=>Wn(_,n,r),[t]),g=Et.sanitize(w.answerHtml);return e.jsxs(v,{className:`${F.answerContainer} ${s&&F.selected}`,verticalAlign:"space-between",children:[e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,horizontalAlign:"space-between",children:[e.jsx(Gt,{}),e.jsxs("div",{children:[e.jsx(Z,{style:{color:"black"},iconProps:{iconName:"Lightbulb"},title:"Show thought process",ariaLabel:"Show thought process",onClick:()=>o(),disabled:!t.context.thoughts?.length}),e.jsx(Z,{style:{color:"black"},iconProps:{iconName:"ClipboardList"},title:"Show supporting content",ariaLabel:"Show supporting content",onClick:()=>c(),disabled:!t.context.data_points}),u&&e.jsx(Zn,{url:S}),p&&e.jsx(Yn,{answer:g})]})]})}),e.jsx(v.Item,{grow:!0,children:e.jsx("div",{className:F.answerText,dangerouslySetInnerHTML:{__html:g}})}),!!w.citations.length&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,tokens:{childrenGap:5},children:[e.jsx("span",{className:F.citationLearnMore,children:"Citations:"}),w.citations.map((x,j)=>{const q=Vt(x);return e.jsx("a",{className:F.citation,title:x,onClick:()=>r(q),children:`${++j}. ${x}`},j)})]})}),!!y?.length&&l&&h&&e.jsx(v.Item,{children:e.jsxs(v,{horizontal:!0,wrap:!0,className:`${w.citations.length?F.followupQuestionsList:""}`,tokens:{childrenGap:6},children:[e.jsx("span",{className:F.followupQuestionLearnMore,children:"Follow-up questions:"}),y.map((x,j)=>e.jsx("a",{className:F.followupQuestion,title:x,onClick:()=>h(x),children:`${x}`},j))]})})]})},ea=()=>{const t=ws({from:{opacity:0},to:{opacity:1}});return e.jsx(vs.div,{style:{...t},children:e.jsxs(v,{className:F.answerContainer,verticalAlign:"space-between",children:[e.jsx(Gt,{}),e.jsx(v.Item,{grow:!0,children:e.jsxs("p",{className:F.answerText,children:["Generating answer",e.jsx("span",{className:F.loadingdots})]})})]})})},ta=({error:t,onRetry:s})=>e.jsxs(v,{className:F.answerContainer,verticalAlign:"space-between",children:[e.jsx(Os,{"aria-hidden":"true","aria-label":"Error icon",primaryFill:"red"}),e.jsx(v.Item,{grow:!0,children:e.jsx("p",{className:F.answerText,children:t})}),e.jsx($s,{className:F.retryButton,onClick:s,text:"Retry"})]}),sa="_questionInputContainer_1nmg4_1",na="_questionInputTextArea_1nmg4_23",aa="_questionInputButtonsContainer_1nmg4_33",pe={questionInputContainer:sa,questionInputTextArea:na,questionInputButtonsContainer:aa},oa=window.speechRecognition||window.webkitSpeechRecognition;let L=null;try{L=new oa,L!=null&&(L.lang="en-US",L.interimResults=!0)}catch{console.error("SpeechRecognition not supported"),L=null}const ra=({updateQuestion:t})=>{const[s,n]=i.useState(!1),r=()=>{if(L==null){console.error("SpeechRecognition not supported");return}L.onresult=c=>{let h="";for(const l of c.results)h+=l[0].transcript;t(h)},L.onend=()=>{n(!1)},L.onerror=c=>{L&&(L.stop(),c.error=="no-speech"?alert("No speech was detected. Please check your system audio settings and try again."):c.error=="language-not-supported"?alert(`Speech recognition error detected: ${c.error}. The speech recognition input functionality does not yet work on all browsers, like Edge in Mac OS X with ARM chips. Try another browser/OS.`):alert(`Speech recognition error detected: ${c.error}.`))},n(!0),L.start()},o=()=>{if(L==null){console.error("SpeechRecognition not supported");return}L.stop(),n(!1)};return L==null?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[!s&&e.jsx("div",{className:pe.questionInputButtonsContainer,children:e.jsx(Ue,{content:"Ask question with voice",relationship:"label",children:e.jsx(W,{size:"large",icon:e.jsx(kt,{primaryFill:"rgba(115, 118, 225, 1)"}),onClick:r})})}),s&&e.jsx("div",{className:pe.questionInputButtonsContainer,children:e.jsx(Ue,{content:"Stop recording question",relationship:"label",children:e.jsx(W,{size:"large",icon:e.jsx(kt,{primaryFill:"rgba(250, 0, 0, 0.7)"}),disabled:!s,onClick:o})})})]})},me=i.createContext({loggedIn:!1,setLoggedIn:t=>{}}),ia=({onSend:t,disabled:s,placeholder:n,clearOnSend:r,initQuestion:o,showSpeechInput:c})=>{const[h,l]=i.useState(""),{loggedIn:u}=i.useContext(me);i.useEffect(()=>{o&&l(o)},[o]);const p=()=>{s||!h.trim()||(t(h),r&&l(""))},S=g=>{g.key==="Enter"&&!g.shiftKey&&(g.preventDefault(),p())},y=(g,x)=>{x?x.length<=1e3&&l(x):l("")},_=Nt&&!u,w=s||!h.trim()||Nt;return _&&(n="Please login to continue..."),e.jsxs(v,{horizontal:!0,className:pe.questionInputContainer,children:[e.jsx(H,{className:pe.questionInputTextArea,disabled:_,placeholder:n,multiline:!0,resizable:!1,borderless:!0,value:h,onChange:y,onKeyDown:S}),e.jsx("div",{className:pe.questionInputButtonsContainer,children:e.jsx(Ue,{content:"Submit question",relationship:"label",children:e.jsx(W,{size:"large",icon:e.jsx(Bs,{primaryFill:"rgba(115, 118, 225, 1)"}),disabled:w,onClick:p})})}),c&&e.jsx(ra,{updateQuestion:l})]})},la="_examplesNavList_1qnco_1",ca="_example_1qnco_1",da="_exampleText_1qnco_57",Ve={examplesNavList:la,example:ca,exampleText:da},ua=({text:t,value:s,onClick:n})=>e.jsx("div",{className:Ve.example,onClick:()=>n(s),children:e.jsx("p",{className:Ve.exampleText,children:t})}),ha=["What is included in my Northwind Health Plus plan that is not in standard?","What happens in a performance review?","What does a Product Manager do?"],pa=["Compare the impact of interest rates and GDP in financial markets.","What is the expected trend for the S&P 500 index over the next five years? Compare it to the past S&P 500 performance","Can you identify any correlation between oil prices and stock market trends?"],ma=({onExampleClicked:t,useGPT4V:s})=>e.jsx("ul",{className:Ve.examplesNavList,children:(s?pa:ha).map((n,r)=>e.jsx("li",{children:e.jsx(ua,{text:n,value:n,onClick:t})},r))}),ga="_container_1atyp_1",xa="_message_1atyp_17",Ft={container:ga,message:xa},ve=({message:t})=>e.jsx("div",{className:Ft.container,children:e.jsx("div",{className:Ft.message,children:t})}),Pt={childrenGap:4,maxWidth:300},fa={root:{padding:20}},ba={root:{marginBottom:-3}},Sa={iconName:"Info"},k=t=>{const[s,{toggle:n}]=zs(!1),r=m("description"),o=m("iconButton");return e.jsxs(e.Fragment,{children:[e.jsxs(v,{horizontal:!0,verticalAlign:"center",tokens:Pt,children:[e.jsx("label",{id:t.labelId,htmlFor:t.fieldId,children:t.label}),e.jsx(Z,{id:o,iconProps:Sa,title:"Info",ariaLabel:"Info",onClick:n,styles:ba})]}),s&&e.jsx(Ut,{target:"#"+o,setInitialFocus:!0,onDismiss:n,ariaDescribedBy:r,role:"alertdialog",children:e.jsxs(v,{tokens:Pt,horizontalAlign:"start",styles:fa,children:[e.jsx("span",{id:r,children:t.helpText}),e.jsx(Ge,{onClick:n,children:"Close"})]})})]})},ya="_thoughtProcess_b834q_1",_a="_tList_b834q_15",wa="_tListItem_b834q_27",va="_tStep_b834q_79",ja="_tCodeBlock_b834q_93",Ca="_tProp_b834q_101",Ta="_citationImg_b834q_119",Y={thoughtProcess:ya,tList:_a,tListItem:wa,tStep:va,tCodeBlock:ja,tProp:Ca,citationImg:Ta};function ka(t){const s=t.split(": "),n=s[0],r=Et.sanitize(s.slice(1).join(": "));return{title:n,content:r}}const Ia="_supportingContentNavList_17cb2_1",La="_supportingContentItem_17cb2_17",Na="_supportingContentItemHeader_17cb2_45",Aa="_supportingContentItemText_17cb2_53",Fa="_supportingContentItemImage_17cb2_63",ce={supportingContentNavList:Ia,supportingContentItem:La,supportingContentItemHeader:Na,supportingContentItemText:Aa,supportingContentItemImage:Fa},Pa=({supportingContent:t})=>{const s=Array.isArray(t)?t:t.text,n=Array.isArray(t)?[]:t?.images;return e.jsxs("ul",{className:ce.supportingContentNavList,children:[s.map((r,o)=>{const c=ka(r);return e.jsxs("li",{className:ce.supportingContentItem,children:[e.jsx("h4",{className:ce.supportingContentItemHeader,children:c.title}),e.jsx("p",{className:ce.supportingContentItemText,dangerouslySetInnerHTML:{__html:c.content}})]},o)}),n?.map((r,o)=>e.jsx("img",{className:ce.supportingContentItemImage,src:r.url},o))]})};var U=(t=>(t.ThoughtProcessTab="thoughtProcess",t.SupportingContentTab="supportingContent",t.CitationTab="citation",t))(U||{});const Ra=({thoughts:t})=>e.jsx("ul",{className:Y.tList,children:t.map((s,n)=>e.jsxs("li",{className:Y.tListItem,children:[e.jsx("div",{className:Y.tStep,children:s.title}),e.jsx(v,{horizontal:!0,tokens:{childrenGap:5},children:s.props&&(Object.keys(s.props)||[]).map(r=>e.jsxs("span",{className:Y.tProp,children:[r,": ",JSON.stringify(s.props?.[r])]}))}),Array.isArray(s.description)?e.jsx(js,{language:"json",wrapLongLines:!0,className:Y.tCodeBlock,children:JSON.stringify(s.description,null,2)}):e.jsx("div",{children:s.description})]},n))}),Ea="_downloadButton_1v0ef_1",Ma="_markdownViewer_1v0ef_11",Ua="_loading_1v0ef_29",Oa="_error_1v0ef_41",Ba="_markdown_1v0ef_11",D={downloadButton:Ea,markdownViewer:Ma,loading:Ua,error:Oa,markdown:Ba},Va=({src:t})=>{const[s,n]=i.useState(""),[r,o]=i.useState(!0),[c,h]=i.useState(null),l=u=>{const p=/<a\s+(?:[^>]*?\s+)?href=['"](#[^"']*?)['"][^>]*?>/g;return u.replace(p,"")};return i.useEffect(()=>{(async()=>{try{const p=await fetch(t);if(!p.ok)throw new Error("Failed loading markdown file.");const S=await p.text(),y=await Cs.parse(S),_=l(y);n(_)}catch(p){h(p)}finally{o(!1)}})()},[t]),e.jsx("div",{children:r?e.jsx("div",{className:`${D.loading} ${D.markdownViewer}`,children:e.jsx(Ds,{size:Hs.large,label:"Loading file"})}):c?e.jsx("div",{className:`${D.error} ${D.markdownViewer}`,children:e.jsxs(Qs,{messageBarType:Ks.error,isMultiline:!1,children:[c.message,e.jsx(Ws,{href:t,download:!0,children:"Download the file"})]})}):e.jsxs("div",{children:[e.jsx(Z,{className:D.downloadButton,style:{color:"black"},iconProps:{iconName:"Save"},title:"Save",ariaLabel:"Save",href:t,download:!0}),e.jsx("div",{className:`${D.markdown} ${D.markdownViewer}`,dangerouslySetInnerHTML:{__html:s}})]})})},Me={disabled:!0,style:{color:"grey"}},Ga=({answer:t,activeTab:s,activeCitation:n,citationHeight:r,className:o,onActiveTabChanged:c})=>{const h=!t.context.thoughts,l=!t.context.data_points,u=!n,[p,S]=i.useState(""),y=G?ge().instance:void 0,_=async()=>{const g=y?await he(y):void 0;if(n){const x=n.indexOf("#")?n.split("#")[1]:"",q=await(await fetch(n,{method:"GET",headers:await ee(g)})).blob();let O=URL.createObjectURL(q);x&&(O+="#"+x),S(O)}};i.useEffect(()=>{_()},[]);const w=()=>{if(!n)return null;switch(n.split(".").pop()?.toLowerCase()){case"png":return e.jsx("img",{src:p,className:Y.citationImg,alt:"Citation Image"});case"md":return e.jsx(Va,{src:n});default:return e.jsx("iframe",{title:"Citation",src:p,width:"100%",height:r})}};return e.jsxs(Js,{className:o,selectedKey:s,onLinkClick:g=>g&&c(g.props.itemKey),children:[e.jsx(Re,{itemKey:U.ThoughtProcessTab,headerText:"Thought process",headerButtonProps:h?Me:void 0,children:e.jsx(Ra,{thoughts:t.context.thoughts||[]})}),e.jsx(Re,{itemKey:U.SupportingContentTab,headerText:"Supporting content",headerButtonProps:l?Me:void 0,children:e.jsx(Pa,{supportingContent:t.context.data_points})}),e.jsx(Re,{itemKey:U.CitationTab,headerText:"Citation",headerButtonProps:u?Me:void 0,children:w()})]})},qa="_container_1k5c7_1",$a={container:qa},za=({className:t,onClick:s})=>e.jsx("div",{className:`${$a.container} ${t??""}`,children:e.jsx(W,{icon:e.jsx(Vs,{}),onClick:s,children:"Developer settings"})}),Da="_container_1k5c7_1",Ha={container:Da},Qa=({className:t,disabled:s,onClick:n})=>e.jsx("div",{className:`${Ha.container} ${t??""}`,children:e.jsx(W,{icon:e.jsx(Mt,{}),disabled:s,onClick:n,children:"Clear chat"})}),Ka="_container_abt3k_1",Wa="_callout_abt3k_15",Ja="_list_abt3k_25",Xa="_item_abt3k_37",de={container:Ka,callout:Wa,list:Ja,item:Xa},Ya=({className:t,disabled:s})=>{const[n,r]=i.useState(!1),[o,c]=i.useState(!1),[h,l]=i.useState(!0),[u,p]=i.useState({}),[S,y]=i.useState(),[_,w]=i.useState(),[g,x]=i.useState([]);if(!G)throw new Error("The UploadFile component requires useLogin to be true");const j=ge().instance,q=async()=>{r(!n);try{const b=await he(j);if(!b)throw new Error("No authentication token available");O(b)}catch(b){console.error(b),l(!1)}},O=async b=>{En(b).then(C=>{l(!1),p({}),x(C)})},Ce=async b=>{p({...u,[b]:"pending"});try{const C=await he(j);if(!C)throw new Error("No authentication token available");await Rn(b,C),p({...u,[b]:"success"}),O(C)}catch(C){p({...u,[b]:"error"}),console.error(C)}},te=async b=>{if(b.preventDefault(),!b.target.files||b.target.files.length===0)return;c(!0);const C=b.target.files[0],fe=new FormData;fe.append("file",C);try{const $=await he(j);if(!$)throw new Error("No authentication token available");const Te=await Pn(fe,$);y(Te),c(!1),w(void 0),O($)}catch($){console.error($),c(!1),w("Error uploading file - please try again or contact admin.")}};return e.jsx("div",{className:`${de.container} ${t??""}`,children:e.jsxs("div",{children:[e.jsx(W,{id:"calloutButton",icon:e.jsx(Gs,{}),disabled:s,onClick:q,children:"Manage file uploads"}),n&&e.jsxs(Ut,{role:"dialog",gapSpace:0,className:de.callout,target:"#calloutButton",onDismiss:()=>r(!1),setInitialFocus:!0,children:[e.jsx("form",{encType:"multipart/form-data",children:e.jsxs("div",{children:[e.jsx(Ot,{children:"Upload file:"}),e.jsx("input",{accept:".txt, .md, .json, .png, .jpg, .jpeg, .bmp, .heic, .tiff, .pdf, .docx, .xlsx, .pptx, .html",className:de.chooseFiles,type:"file",onChange:te})]})}),o&&e.jsx(le,{children:"Uploading files..."}),!o&&_&&e.jsx(le,{children:_}),!o&&S&&e.jsx(le,{children:S.message}),e.jsx("h3",{children:"Previously uploaded files:"}),h&&e.jsx(le,{children:"Loading..."}),!h&&g.length===0&&e.jsx(le,{children:"No files uploaded yet"}),g.map((b,C)=>e.jsxs("div",{className:de.list,children:[e.jsx("div",{className:de.item,children:b}),e.jsxs(W,{icon:e.jsx(Mt,{}),onClick:()=>Ce(b),disabled:u[b]==="pending"||u[b]==="success",children:[!u[b]&&"Delete file",u[b]=="pending"&&"Deleting file...",u[b]=="error"&&"Error deleting.",u[b]=="success"&&"File deleted"]})]},C))]})]})})},Za="_container_1142u_1",eo={container:Za},I={promptTemplate:"Overrides the prompt used to generate the answer based on the question and search results. To append to existing prompt instead of replace whole prompt, start your prompt with '>>>'.",temperature:"Sets the temperature of the request to the LLM that generates the answer. Higher temperatures result in more creative responses, but they may be less grounded.",searchScore:"Sets a minimum score for search results coming back from Azure AI search. The score range depends on whether you're using hybrid (default), vectors only, or text only.",rerankerScore:"Sets a minimum score for search results coming back from the semantic reranker. The score always ranges between 0-4. The higher the score, the more semantically relevant the result is to the question.",retrieveNumber:"Sets the number of search results to retrieve from Azure AI search. More results may increase the likelihood of finding the correct answer, but may lead to the model getting 'lost in the middle'.",excludeCategory:"Specifies a category to exclude from the search results. There are no categories used in the default data set.",useSemanticReranker:"Enables the Azure AI Search semantic ranker, a model that re-ranks search results based on semantic similarity to the user's query.",useSemanticCaptions:"Sends semantic captions to the LLM instead of the full search result. A semantic caption is extracted from a search result during the process of semantic ranking.",suggestFollowupQuestions:"Asks the LLM to suggest follow-up questions based on the user's query.",useGPT4Vision:"Uses GPT-4-Turbo with Vision to generate responses based on images and text from the index.",vectorFields:"Specifies which embedding fields in the Azure AI Search Index will be searched, both the 'Images and text' embeddings, 'Images' only, or 'Text' only.",gpt4VisionInputs:"Sets what will be sent to the vision model. 'Images and text' sends both images and text to the model, 'Images' sends only images, and 'Text' sends only text.",retrievalMode:"Sets the retrieval mode for the Azure AI Search query. `Vectors + Text (Hybrid)` uses a combination of vector search and full text search, `Vectors` uses only vector search, and `Text` uses only full text search. Hybrid is generally optimal.",streamChat:"Continuously streams the response to the chat UI as it is generated.",useOidSecurityFilter:"Filter search results based on the authenticated user's OID.",useGroupsSecurityFilter:"Filter search results based on the authenticated user's groups."},to=({updateRetrievalMode:t,updateVectorFields:s,showImageOptions:n,defaultRetrievalMode:r})=>{const[o,c]=i.useState(A.Hybrid),[h,l]=i.useState(M.Both),u=(g,x)=>{c(x?.data||A.Hybrid),t(x?.data||A.Hybrid)},p=(g,x)=>{l(x?.key),s([x?.key])};i.useEffect(()=>{s(n?[M.Embedding,M.ImageEmbedding]:[M.Embedding])},[n]);const S=m("retrievalMode"),y=m("retrievalModeField"),_=m("vectorFields"),w=m("vectorFieldsField");return e.jsxs(v,{className:eo.container,tokens:{childrenGap:10},children:[e.jsx(Oe,{id:y,label:"Retrieval mode",selectedKey:r.toString(),options:[{key:"hybrid",text:"Vectors + Text (Hybrid)",selected:o==A.Hybrid,data:A.Hybrid},{key:"vectors",text:"Vectors",selected:o==A.Vectors,data:A.Vectors},{key:"text",text:"Text",selected:o==A.Text,data:A.Text}],required:!0,onChange:u,"aria-labelledby":S,onRenderLabel:g=>e.jsx(k,{labelId:S,fieldId:y,helpText:I.retrievalMode,label:g?.label})}),n&&[A.Vectors,A.Hybrid].includes(o)&&e.jsx(Oe,{id:w,label:"Vector fields (Multi-query vector search)",options:[{key:M.Embedding,text:"Text Embeddings",selected:h===M.Embedding},{key:M.ImageEmbedding,text:"Image Embeddings",selected:h===M.ImageEmbedding},{key:M.Both,text:"Text and Image embeddings",selected:h===M.Both}],onChange:p,"aria-labelledby":_,onRenderLabel:g=>e.jsx(k,{labelId:_,fieldId:w,helpText:I.vectorFields,label:g?.label})})]})},so=()=>{const{instance:t}=ge();t.getActiveAccount();const[s,n]=i.useState(void 0);i.useEffect(()=>{(async()=>{n(await Ln(t))})()},[]);const r=l=>typeof l=="string"?l:JSON.stringify(l),c=(l=>Object.keys(l??{}).map(u=>{let p=u;try{const y=new URL(u).pathname.split("/");u=y[y.length-1]}catch{}return{name:u,value:r((l??{})[p])}}))(s),h=[It({columnId:"name",compare:(l,u)=>l.name.localeCompare(u.name),renderHeaderCell:()=>"Name",renderCell:l=>l.name}),It({columnId:"value",compare:(l,u)=>l.value.localeCompare(u.value),renderHeaderCell:()=>"Value",renderCell:l=>l.value})];return e.jsxs("div",{children:[e.jsx(Ot,{children:"ID Token Claims"}),e.jsxs(Xs,{items:c,columns:h,sortable:!0,getRowId:l=>l.name,children:[e.jsx(Ys,{children:e.jsx(Lt,{children:({renderHeaderCell:l})=>e.jsx(Zs,{children:l()})})}),e.jsx(en,{children:({item:l,rowId:u})=>e.jsx(Lt,{children:({renderCell:p})=>e.jsx(tn,{children:p(l)})},u)})]})]})},no="_container_1142u_1",ao={container:no},oo=({updateGPT4VInputs:t,updateUseGPT4V:s,isUseGPT4V:n,gpt4vInputs:r})=>{const[o,c]=i.useState(n),[h,l]=i.useState(r||V.TextAndImages),u=(g,x)=>{s(!!x),c(!!x)},p=(g,x)=>{if(x){const j=x.key;t(j||V.TextAndImages),j&&l(j)}};i.useEffect(()=>{o&&t(V.TextAndImages)},[o]);const S=m("useGPT4V"),y=m("useGPT4VField"),_=m("gpt4VInput"),w=m("gpt4VInputField");return e.jsxs(v,{className:ao.container,tokens:{childrenGap:10},children:[e.jsx(Q,{id:y,checked:o,label:"Use GPT vision model",onChange:u,"aria-labelledby":S,onRenderLabel:g=>e.jsx(k,{labelId:S,fieldId:y,helpText:I.useGPT4Vision,label:g?.label})}),o&&e.jsx(Oe,{id:w,selectedKey:h,label:"GPT vision model inputs",options:[{key:V.TextAndImages,text:"Images and text"},{text:"Images",key:V.Images},{text:"Text",key:V.Texts}],required:!0,onChange:p,"aria-labelledby":_,onRenderLabel:g=>e.jsx(k,{labelId:_,fieldId:w,helpText:I.gpt4VisionInputs,label:g?.label})})]})},ro=()=>{const[t,s]=i.useState(!1),[n,r]=i.useState(""),[o,c]=i.useState(.3),[h,l]=i.useState(0),[u,p]=i.useState(0),[S,y]=i.useState(3),[_,w]=i.useState(A.Hybrid),[g,x]=i.useState(!0),[j,q]=i.useState(!0),[O,Ce]=i.useState(!1),[te,b]=i.useState(""),[C,fe]=i.useState(!1),[$,Te]=i.useState([M.Embedding]),[qe,qt]=i.useState(!1),[$e,$t]=i.useState(!1),[ze,zt]=i.useState(V.TextAndImages),[be,Dt]=i.useState(!1),z=i.useRef(""),ke=i.useRef(null),[Se,ye]=i.useState(!1),[De,Ie]=i.useState(!1),[_e,Le]=i.useState(),[He,Ne]=i.useState(),[se,X]=i.useState(void 0),[ne,Qe]=i.useState(0),[T,Ae]=i.useState([]),[Ke,We]=i.useState([]),[ae,Ht]=i.useState([]),[Je,Qt]=i.useState(!1),[Xe,Kt]=i.useState(!1),[Wt,Jt]=i.useState(!1),[Xt,Yt]=i.useState(!1),[Zt,es]=i.useState(!1),[Ye,ts]=i.useState(!1),[Fe,ss]=i.useState(!1),ns=async()=>{Nn().then(a=>{Qt(a.showGPT4VOptions),x(a.showSemanticRankerOption),Kt(a.showSemanticRankerOption),Jt(a.showVectorOption),a.showVectorOption||w(A.Text),Yt(a.showUserUpload),es(a.showSpeechInput),ts(a.showSpeechOutputBrowser),ss(a.showSpeechOutputAzure)})},as=async(a,d,E)=>{let ie="",P={};const B=R=>new Promise(Ss=>{setTimeout(()=>{ie+=R;const ys={...P,message:{content:ie,role:P.message.role}};We([...d,[a,ys]]),Ss(null)},33)});try{Ie(!0);for await(const R of Ts(E))if(R.context&&R.context.data_points)R.message=R.delta,P=R;else if(R.delta.content)ye(!1),await B(R.delta.content);else if(R.context)P.context={...P.context,...R.context};else if(R.error)throw Error(R.error)}finally{Ie(!1)}return{...P,message:{content:ie,role:P.message.role}}},Ze=G?ge().instance:void 0,{loggedIn:Pe}=i.useContext(me),oe=async a=>{z.current=a,_e&&Le(void 0),ye(!0),Ne(void 0),X(void 0);const d=Ze?await he(Ze):void 0;try{const ie={messages:[...T.flatMap(B=>[{content:B[0],role:"user"},{content:B[1].message.content,role:"assistant"}]),{content:a,role:"user"}],context:{overrides:{prompt_template:n.length===0?void 0:n,exclude_category:te.length===0?void 0:te,top:S,temperature:o,minimum_reranker_score:h,minimum_search_score:u,retrieval_mode:_,semantic_ranker:g,semantic_captions:O,suggest_followup_questions:C,use_oid_security_filter:qe,use_groups_security_filter:$e,vector_fields:$,use_gpt4v:be,gpt4v_input:ze}},session_state:T.length?T[T.length-1][1].session_state:null},P=await An(ie,j,d);if(!P.body)throw Error("No response body");if(j){const B=await as(a,T,P.body);Ae([...T,[a,B]])}else{const B=await P.json();if(P.status>299||!P.ok)throw Error(B.error||"Unknown error");Ae([...T,[a,B]])}}catch(E){Le(E)}finally{ye(!1)}},os=()=>{z.current="",_e&&Le(void 0),Ne(void 0),X(void 0),Ae([]),We([]),ye(!1),Ie(!1)};i.useEffect(()=>ke.current?.scrollIntoView({behavior:"smooth"}),[Se]),i.useEffect(()=>ke.current?.scrollIntoView({behavior:"auto"}),[Ke]),i.useEffect(()=>{ns()},[]),i.useEffect(()=>{if(T&&Fe)for(let a=0;a<T.length;a++)ae[a]||Fn(T[a][1].message.content).then(d=>{Ht([...ae.slice(0,a),d,...ae.slice(a+1)])})},[T]);const rs=(a,d)=>{r(d||"")},is=(a,d)=>{c(parseFloat(d||"0"))},ls=(a,d)=>{p(parseFloat(d||"0"))},cs=(a,d)=>{l(parseFloat(d||"0"))},ds=(a,d)=>{y(parseInt(d||"3"))},us=(a,d)=>{x(!!d)},hs=(a,d)=>{Ce(!!d)},ps=(a,d)=>{q(!!d)},ms=(a,d)=>{b(d||"")},gs=(a,d)=>{fe(!!d)},xs=(a,d)=>{qt(!!d)},fs=(a,d)=>{$t(!!d)},bs=a=>{oe(a)},et=(a,d)=>{He===a&&se===U.CitationTab&&ne===d?X(void 0):(Ne(a),X(U.CitationTab)),Qe(d)},re=(a,d)=>{X(se===a&&ne===d?void 0:a),Qe(d)},tt=m("promptTemplate"),st=m("promptTemplateField"),nt=m("temperature"),at=m("temperatureField"),ot=m("searchScore"),rt=m("searchScoreField"),it=m("rerankerScore"),lt=m("rerankerScoreField"),ct=m("retrieveCount"),dt=m("retrieveCountField"),ut=m("excludeCategory"),ht=m("excludeCategoryField"),pt=m("semanticRanker"),mt=m("semanticRankerField"),gt=m("semanticCaptions"),xt=m("semanticCaptionsField"),ft=m("suggestFollowupQuestions"),bt=m("suggestFollowupQuestionsField"),St=m("useOidSecurityFilter"),yt=m("useOidSecurityFilterField"),_t=m("useGroupsSecurityFilter"),wt=m("useGroupsSecurityFilterField"),vt=m("shouldStream"),jt=m("shouldStreamField");return e.jsxs("div",{className:f.container,children:[e.jsxs("div",{className:f.commandsContainer,children:[e.jsx(Qa,{className:f.commandButton,onClick:os,disabled:!z.current||Se}),Xt&&e.jsx(Ya,{className:f.commandButton,disabled:!Pe}),e.jsx(za,{className:f.commandButton,onClick:()=>s(!t)})]}),e.jsxs("div",{className:f.chatRoot,children:[e.jsxs("div",{className:f.chatContainer,children:[z.current?e.jsxs("div",{className:f.chatMessageStream,children:[De&&Ke.map((a,d)=>e.jsxs("div",{children:[e.jsx(ve,{message:a[0]}),e.jsx("div",{className:f.chatMessageGpt,children:e.jsx(At,{isStreaming:!0,answer:a[1],isSelected:!1,onCitationClicked:E=>et(E,d),onThoughtProcessClicked:()=>re(U.ThoughtProcessTab,d),onSupportingContentClicked:()=>re(U.SupportingContentTab,d),onFollowupQuestionClicked:E=>oe(E),showFollowupQuestions:C&&T.length-1===d,showSpeechOutputAzure:Fe,showSpeechOutputBrowser:Ye,speechUrl:ae[d]},d)})]},d)),!De&&T.map((a,d)=>e.jsxs("div",{children:[e.jsx(ve,{message:a[0]}),e.jsx("div",{className:f.chatMessageGpt,children:e.jsx(At,{isStreaming:!1,answer:a[1],isSelected:ne===d&&se!==void 0,onCitationClicked:E=>et(E,d),onThoughtProcessClicked:()=>re(U.ThoughtProcessTab,d),onSupportingContentClicked:()=>re(U.SupportingContentTab,d),onFollowupQuestionClicked:E=>oe(E),showFollowupQuestions:C&&T.length-1===d,showSpeechOutputAzure:Fe,showSpeechOutputBrowser:Ye,speechUrl:ae[d]},d)})]},d)),Se&&e.jsxs(e.Fragment,{children:[e.jsx(ve,{message:z.current}),e.jsx("div",{className:f.chatMessageGptMinWidth,children:e.jsx(ea,{})})]}),_e?e.jsxs(e.Fragment,{children:[e.jsx(ve,{message:z.current}),e.jsx("div",{className:f.chatMessageGptMinWidth,children:e.jsx(ta,{error:_e.toString(),onRetry:()=>oe(z.current)})})]}):null,e.jsx("div",{ref:ke})]}):e.jsxs("div",{className:f.chatEmptyState,children:[e.jsx(qs,{fontSize:"120px",primaryFill:"rgba(115, 118, 225, 1)","aria-hidden":"true","aria-label":"Chat logo"}),e.jsx("h1",{className:f.chatEmptyStateTitle,children:"Chat with your data"}),e.jsx("h2",{className:f.chatEmptyStateSubtitle,children:"Ask anything or try an example"}),e.jsx(ma,{onExampleClicked:bs,useGPT4V:be})]}),e.jsx("div",{className:f.chatInput,children:e.jsx(ia,{clearOnSend:!0,placeholder:"Type a new question (e.g. does my plan cover annual eye exams?)",disabled:Se,onSend:a=>oe(a),showSpeechInput:Zt})})]}),T.length>0&&se&&e.jsx(Ga,{className:f.chatAnalysisPanel,activeCitation:He,onActiveTabChanged:a=>re(a,ne),citationHeight:"810px",answer:T[ne][1],activeTab:se}),e.jsxs(sn,{headerText:"Configure answer generation",isOpen:t,isBlocking:!1,onDismiss:()=>s(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>e.jsx(Ge,{onClick:()=>s(!1),children:"Close"}),isFooterAtBottom:!0,children:[e.jsx(H,{id:st,className:f.chatSettingsSeparator,defaultValue:n,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:rs,"aria-labelledby":tt,onRenderLabel:a=>e.jsx(k,{labelId:tt,fieldId:st,helpText:I.promptTemplate,label:a?.label})}),e.jsx(H,{id:at,className:f.chatSettingsSeparator,label:"Temperature",type:"number",min:0,max:1,step:.1,defaultValue:o.toString(),onChange:is,"aria-labelledby":nt,onRenderLabel:a=>e.jsx(k,{labelId:nt,fieldId:at,helpText:I.temperature,label:a?.label})}),e.jsx(H,{id:rt,className:f.chatSettingsSeparator,label:"Minimum search score",type:"number",min:0,step:.01,defaultValue:u.toString(),onChange:ls,"aria-labelledby":ot,onRenderLabel:a=>e.jsx(k,{labelId:ot,fieldId:rt,helpText:I.searchScore,label:a?.label})}),Xe&&e.jsx(H,{id:lt,className:f.chatSettingsSeparator,label:"Minimum reranker score",type:"number",min:1,max:4,step:.1,defaultValue:h.toString(),onChange:cs,"aria-labelledby":it,onRenderLabel:a=>e.jsx(k,{labelId:it,fieldId:lt,helpText:I.rerankerScore,label:a?.label})}),e.jsx(H,{id:dt,className:f.chatSettingsSeparator,label:"Retrieve this many search results:",type:"number",min:1,max:50,defaultValue:S.toString(),onChange:ds,"aria-labelledby":ct,onRenderLabel:a=>e.jsx(k,{labelId:ct,fieldId:dt,helpText:I.retrieveNumber,label:a?.label})}),e.jsx(H,{id:ht,className:f.chatSettingsSeparator,label:"Exclude category",defaultValue:te,onChange:ms,"aria-labelledby":ut,onRenderLabel:a=>e.jsx(k,{labelId:ut,fieldId:ht,helpText:I.excludeCategory,label:a?.label})}),Xe&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:mt,className:f.chatSettingsSeparator,checked:g,label:"Use semantic ranker for retrieval",onChange:us,"aria-labelledby":pt,onRenderLabel:a=>e.jsx(k,{labelId:pt,fieldId:mt,helpText:I.useSemanticReranker,label:a?.label})}),e.jsx(Q,{id:xt,className:f.chatSettingsSeparator,checked:O,label:"Use semantic captions",onChange:hs,disabled:!g,"aria-labelledby":gt,onRenderLabel:a=>e.jsx(k,{labelId:gt,fieldId:xt,helpText:I.useSemanticCaptions,label:a?.label})})]}),e.jsx(Q,{id:bt,className:f.chatSettingsSeparator,checked:C,label:"Suggest follow-up questions",onChange:gs,"aria-labelledby":ft,onRenderLabel:a=>e.jsx(k,{labelId:ft,fieldId:bt,helpText:I.suggestFollowupQuestions,label:a?.label})}),Je&&e.jsx(oo,{gpt4vInputs:ze,isUseGPT4V:be,updateUseGPT4V:a=>{Dt(a)},updateGPT4VInputs:a=>zt(a)}),Wt&&e.jsx(to,{defaultRetrievalMode:_,showImageOptions:be&&Je,updateVectorFields:a=>Te(a),updateRetrievalMode:a=>w(a)}),G&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{id:yt,className:f.chatSettingsSeparator,checked:qe||ue,label:"Use oid security filter",disabled:!Pe||ue,onChange:xs,"aria-labelledby":St,onRenderLabel:a=>e.jsx(k,{labelId:St,fieldId:yt,helpText:I.useOidSecurityFilter,label:a?.label})}),e.jsx(Q,{id:wt,className:f.chatSettingsSeparator,checked:$e||ue,label:"Use groups security filter",disabled:!Pe||ue,onChange:fs,"aria-labelledby":_t,onRenderLabel:a=>e.jsx(k,{labelId:_t,fieldId:wt,helpText:I.useGroupsSecurityFilter,label:a?.label})})]}),e.jsx(Q,{id:jt,className:f.chatSettingsSeparator,checked:j,label:"Stream chat completion responses",onChange:ps,"aria-labelledby":vt,onRenderLabel:a=>e.jsx(k,{labelId:vt,fieldId:jt,helpText:I.streamChat,label:a?.label})}),G&&e.jsx(so,{})]})]})]})},io="/assets/github-fab00c2d.svg",lo="_layout_o4bzc_1",co="_header_o4bzc_13",uo="_headerContainer_o4bzc_23",ho="_headerTitleContainer_o4bzc_39",po="_headerLogo_o4bzc_55",mo="_headerTitle_o4bzc_39",go="_headerNavList_o4bzc_73",xo="_headerNavPageLink_o4bzc_85",fo="_headerNavPageLinkActive_o4bzc_113",bo="_headerNavLeftMargin_o4bzc_123",So="_headerRightText_o4bzc_131",yo="_microsoftLogo_o4bzc_141",_o="_githubLogo_o4bzc_151",N={layout:lo,header:co,headerContainer:uo,headerTitleContainer:ho,headerLogo:po,headerTitle:mo,headerNavList:go,headerNavPageLink:xo,headerNavPageLinkActive:fo,headerNavLeftMargin:bo,headerRightText:So,microsoftLogo:yo,githubLogo:_o},wo="_loginButton_l76ou_1",vo={loginButton:wo},jo=()=>{const{instance:t}=ge(),{loggedIn:s,setLoggedIn:n}=i.useContext(me),r=t.getActiveAccount(),[o,c]=i.useState("");i.useEffect(()=>{(async()=>{c(await Ee(t)??"")})()},[]);const h=()=>{t.loginPopup({...Cn,redirectUri:Bt()}).catch(u=>console.log(u)).then(async()=>{n(await Be(t)),c(await Ee(t)??"")})},l=()=>{r?t.logoutPopup({mainWindowRedirectUri:"/",account:t.getActiveAccount()}).catch(u=>console.log(u)).then(async()=>{n(await Be(t)),c(await Ee(t)??"")}):In()};return e.jsx(Ge,{text:s?`Logout
${o}`:"Login",className:vo.loginButton,onClick:s?l:h})},Rt=()=>e.jsxs("div",{className:N.layout,children:[e.jsx("header",{className:N.header,role:"banner",children:e.jsxs("div",{className:N.headerContainer,children:[e.jsx(ks,{to:"/",className:N.headerTitleContainer,children:e.jsx("h3",{className:N.headerTitle,children:"GPT + Enterprise data | Sample"})}),e.jsx("nav",{children:e.jsxs("ul",{className:N.headerNavList,children:[e.jsx("li",{children:e.jsx(Ct,{to:"/",className:({isActive:t})=>t?N.headerNavPageLinkActive:N.headerNavPageLink,children:"Chat"})}),e.jsx("li",{className:N.headerNavLeftMargin,children:e.jsx(Ct,{to:"/qa",className:({isActive:t})=>t?N.headerNavPageLinkActive:N.headerNavPageLink,children:"Ask a question"})}),e.jsx("li",{className:N.headerNavLeftMargin,children:e.jsx("a",{href:"https://aka.ms/entgptsearch",target:"_blank",title:"Github repository link",children:e.jsx("img",{src:io,alt:"Github logo","aria-label":"Link to github repository",width:"20px",height:"20px",className:N.githubLogo})})})]})}),e.jsx("h4",{className:N.headerRightText,children:"Azure OpenAI + AI Search"}),G&&e.jsx(jo,{})]})}),e.jsx(Is,{})]}),Co=()=>{const[t,s]=i.useState(!1);if(G){var n=new Ls(jn);return!n.getActiveAccount()&&n.getAllAccounts().length>0&&n.setActiveAccount(n.getActiveAccount()),n.addEventCallback(r=>{if(r.eventType===Ns.LOGIN_SUCCESS&&r.payload){const o=r.payload;n.setActiveAccount(o)}}),i.useEffect(()=>{(async()=>{s(await Be(n))})()},[]),e.jsx(As,{instance:n,children:e.jsx(me.Provider,{value:{loggedIn:t,setLoggedIn:s},children:e.jsx(Rt,{})})})}else return e.jsx(me.Provider,{value:{loggedIn:t,setLoggedIn:s},children:e.jsx(Rt,{})})};Fs();const To=Ps([{path:"/",element:e.jsx(Co,{}),children:[{index:!0,element:e.jsx(ro,{})},{path:"qa",lazy:()=>Tt(()=>import("./Ask-fc321fe0.js"),["assets/Ask-fc321fe0.js","assets/vendor-bdbde4de.js","assets/fluentui-react-daad5bea.js","assets/fluentui-icons-6b98e6c1.js","assets/Ask-8ad3e73e.css"])},{path:"*",lazy:()=>Tt(()=>import("./NoPage-63775732.js"),["assets/NoPage-63775732.js","assets/vendor-bdbde4de.js"])}]}]);Rs.createRoot(document.getElementById("root")).render(e.jsx(Es.StrictMode,{children:e.jsx(Ms,{router:To})}));export{At as A,ma as E,V as G,k as H,me as L,ia as Q,A as R,za as S,so as T,Ya as U,M as V,U as a,ta as b,Ga as c,oo as d,to as e,Nn as f,Fn as g,he as h,Ao as i,ue as r,I as t,G as u};
//# sourceMappingURL=index-35af294b.js.map
