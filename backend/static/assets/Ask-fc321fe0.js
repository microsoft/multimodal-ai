import{r as s,bI as it,bC as t}from"./vendor-bdbde4de.js";import{R as be,G as lt,V as xe,u as F,L as ct,g as ut,U as dt,S as pt,Q as mt,E as St,A as ht,a as S,b as gt,c as bt,H as r,t as i,d as xt,e as Ct,r as h,T as kt,f as Tt,h as yt,i as ft}from"./index-35af294b.js";import{b as o,c as _t,s as It,D as vt,a as c,r as g}from"./fluentui-react-daad5bea.js";import"./fluentui-icons-6b98e6c1.js";const Ft="_askContainer_goaxg_1",jt="_askTopSection_goaxg_15",wt="_askBottomSection_goaxg_29",Rt="_askTitle_goaxg_49",At="_askQuestionInput_goaxg_77",Ot="_askAnswerContainer_goaxg_91",Pt="_askAnalysisPanel_goaxg_105",Vt="_askSettingsSeparator_goaxg_115",Ut="_commandsContainer_goaxg_127",Nt="_commandButton_goaxg_137",n={askContainer:Ft,askTopSection:jt,askBottomSection:wt,askTitle:Rt,askQuestionInput:At,askAnswerContainer:Ot,askAnalysisPanel:Pt,askSettingsSeparator:Vt,commandsContainer:Ut,commandButton:Nt};function Gt(){const[j,b]=s.useState(!1),[x,Ce]=s.useState(""),[w,Lt]=s.useState(""),[R,Bt]=s.useState(""),[A,ke]=s.useState(.3),[O,Te]=s.useState(0),[P,ye]=s.useState(0),[V,U]=s.useState(be.Hybrid),[N,fe]=s.useState(3),[C,G]=s.useState(!0),[L,_e]=s.useState(!1),[d,Ie]=s.useState(!1),[B,ve]=s.useState(lt.TextAndImages),[k,Fe]=s.useState(""),[je,we]=s.useState(""),[Re,Ae]=s.useState([xe.Embedding,xe.ImageEmbedding]),[E,Oe]=s.useState(!1),[M,Pe]=s.useState(!1),[Q,Ve]=s.useState(!1),[D,Ue]=s.useState(!1),[Ne,Ge]=s.useState(!1),[Le,Be]=s.useState(!1),[Ee,Me]=s.useState(!1),[Qe,De]=s.useState(!1),[H,He]=s.useState(!1),T=s.useRef(""),[y,q]=s.useState(!1),[p,z]=s.useState(),[l,qe]=s.useState(),[ze,J]=s.useState(null),[K,W]=s.useState(),[m,u]=s.useState(void 0),X=F?it().instance:void 0,{loggedIn:f}=s.useContext(ct),Je=async()=>{Tt().then(e=>{Ve(e.showGPT4VOptions),G(e.showSemanticRankerOption),Ue(e.showSemanticRankerOption),Ge(e.showVectorOption),e.showVectorOption||U(be.Text),Be(e.showUserUpload),Me(e.showSpeechInput),De(e.showSpeechOutputBrowser),He(e.showSpeechOutputAzure)})};s.useEffect(()=>{Je()},[]),s.useEffect(()=>{l&&H&&ut(l.message.content).then(e=>{J(e)})},[l]);const _=async e=>{T.current=e,p&&z(void 0),q(!0),W(void 0),u(void 0);const a=X?await yt(X):void 0;try{const v={messages:[{content:e,role:"user"}],context:{overrides:{prompt_template:x.length===0?void 0:x,prompt_template_prefix:w.length===0?void 0:w,prompt_template_suffix:R.length===0?void 0:R,exclude_category:k.length===0?void 0:k,top:N,temperature:A,minimum_reranker_score:O,minimum_search_score:P,retrieval_mode:V,semantic_ranker:C,semantic_captions:L,use_oid_security_filter:E,use_groups_security_filter:M,vector_fields:Re,use_gpt4v:d,gpt4v_input:B}},session_state:l?l.session_state:null},rt=await ft(v,a);qe(rt),J(null)}catch(v){z(v)}finally{q(!1)}},Ke=(e,a)=>{Ce(a||"")},We=(e,a)=>{ke(parseFloat(a||"0"))},Xe=(e,a)=>{ye(parseFloat(a||"0"))},Ye=(e,a)=>{Te(parseFloat(a||"0"))},Ze=(e,a)=>{fe(parseInt(a||"3"))},$e=(e,a)=>{G(!!a)},et=(e,a)=>{_e(!!a)},tt=(e,a)=>{Fe(a||"")},st=e=>{_(e),we(e)},at=e=>{K===e&&m===S.CitationTab?u(void 0):(W(e),u(S.CitationTab))},I=e=>{u(m===e?void 0:e)},nt=(e,a)=>{Oe(!!a)},ot=(e,a)=>{Pe(!!a)},Y=o("promptTemplate"),Z=o("promptTemplateField"),$=o("temperature"),ee=o("temperatureField"),te=o("searchScore"),se=o("searchScoreField"),ae=o("rerankerScore"),ne=o("rerankerScoreField"),oe=o("retrieveCount"),re=o("retrieveCountField"),ie=o("excludeCategory"),le=o("excludeCategoryField"),ce=o("semanticRanker"),ue=o("semanticRankerField"),de=o("semanticCaptions"),pe=o("semanticCaptionsField"),me=o("useOidSecurityFilter"),Se=o("useOidSecurityFilterField"),he=o("useGroupsSecurityFilter"),ge=o("useGroupsSecurityFilterField");return t.jsxs("div",{className:n.askContainer,children:[t.jsxs("div",{className:n.askTopSection,children:[t.jsxs("div",{className:n.commandsContainer,children:[Le&&t.jsx(dt,{className:n.commandButton,disabled:f}),t.jsx(pt,{className:n.commandButton,onClick:()=>b(!j)})]}),t.jsx("h1",{className:n.askTitle,children:"Ask your data"}),t.jsx("div",{className:n.askQuestionInput,children:t.jsx(mt,{placeholder:"Example: Does my plan cover annual eye exams?",disabled:y,initQuestion:je,onSend:e=>_(e),showSpeechInput:Ee})})]}),t.jsxs("div",{className:n.askBottomSection,children:[y&&t.jsx(_t,{label:"Generating answer"}),!T.current&&t.jsx(St,{onExampleClicked:st,useGPT4V:d}),!y&&l&&!p&&t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(ht,{answer:l,isStreaming:!1,onCitationClicked:e=>at(e),onThoughtProcessClicked:()=>I(S.ThoughtProcessTab),onSupportingContentClicked:()=>I(S.SupportingContentTab),showSpeechOutputAzure:H,showSpeechOutputBrowser:Qe,speechUrl:ze})}),p?t.jsx("div",{className:n.askAnswerContainer,children:t.jsx(gt,{error:p.toString(),onRetry:()=>_(T.current)})}):null,m&&l&&t.jsx(bt,{className:n.askAnalysisPanel,activeCitation:K,onActiveTabChanged:e=>I(e),citationHeight:"600px",answer:l,activeTab:m})]}),t.jsxs(It,{headerText:"Configure answer generation",isOpen:j,isBlocking:!1,onDismiss:()=>b(!1),closeButtonAriaLabel:"Close",onRenderFooterContent:()=>t.jsx(vt,{onClick:()=>b(!1),children:"Close"}),isFooterAtBottom:!0,children:[t.jsx(c,{id:Z,className:n.chatSettingsSeparator,defaultValue:x,label:"Override prompt template",multiline:!0,autoAdjustHeight:!0,onChange:Ke,"aria-labelledby":Y,onRenderLabel:e=>t.jsx(r,{labelId:Y,fieldId:Z,helpText:i.promptTemplate,label:e?.label})}),t.jsx(c,{id:ee,className:n.chatSettingsSeparator,label:"Temperature",type:"number",min:0,max:1,step:.1,defaultValue:A.toString(),onChange:We,"aria-labelledby":$,onRenderLabel:e=>t.jsx(r,{labelId:$,fieldId:ee,helpText:i.temperature,label:e?.label})}),t.jsx(c,{id:se,className:n.chatSettingsSeparator,label:"Minimum search score",type:"number",min:0,step:.01,defaultValue:P.toString(),onChange:Xe,"aria-labelledby":te,onRenderLabel:e=>t.jsx(r,{labelId:te,fieldId:se,helpText:i.searchScore,label:e?.label})}),D&&t.jsx(c,{id:ne,className:n.chatSettingsSeparator,label:"Minimum reranker score",type:"number",min:1,max:4,step:.1,defaultValue:O.toString(),onChange:Ye,"aria-labelledby":ae,onRenderLabel:e=>t.jsx(r,{labelId:ae,fieldId:ne,helpText:i.rerankerScore,label:e?.label})}),t.jsx(c,{id:re,className:n.chatSettingsSeparator,label:"Retrieve this many search results:",type:"number",min:1,max:50,defaultValue:N.toString(),onChange:Ze,"aria-labelledby":oe,onRenderLabel:e=>t.jsx(r,{labelId:oe,fieldId:re,helpText:i.retrieveNumber,label:e?.label})}),t.jsx(c,{id:le,className:n.chatSettingsSeparator,label:"Exclude category",defaultValue:k,onChange:tt,"aria-labelledby":ie,onRenderLabel:e=>t.jsx(r,{labelId:ie,fieldId:le,helpText:i.excludeCategory,label:e?.label})}),D&&t.jsxs(t.Fragment,{children:[t.jsx(g,{id:ue,className:n.chatSettingsSeparator,checked:C,label:"Use semantic ranker for retrieval",onChange:$e,"aria-labelledby":ce,onRenderLabel:e=>t.jsx(r,{labelId:ce,fieldId:ue,helpText:i.useSemanticReranker,label:e?.label})}),t.jsx(g,{id:pe,className:n.chatSettingsSeparator,checked:L,label:"Use semantic captions",onChange:et,disabled:!C,"aria-labelledby":de,onRenderLabel:e=>t.jsx(r,{labelId:de,fieldId:pe,helpText:i.useSemanticCaptions,label:e?.label})})]}),Q&&t.jsx(xt,{gpt4vInputs:B,isUseGPT4V:d,updateUseGPT4V:e=>{Ie(e)},updateGPT4VInputs:e=>ve(e)}),Ne&&t.jsx(Ct,{defaultRetrievalMode:V,showImageOptions:d&&Q,updateVectorFields:e=>Ae(e),updateRetrievalMode:e=>U(e)}),F&&t.jsxs(t.Fragment,{children:[t.jsx(g,{id:Se,className:n.chatSettingsSeparator,checked:E||h,label:"Use oid security filter",disabled:!f||h,onChange:nt,"aria-labelledby":me,onRenderLabel:e=>t.jsx(r,{labelId:me,fieldId:Se,helpText:i.useOidSecurityFilter,label:e?.label})}),t.jsx(g,{id:ge,className:n.chatSettingsSeparator,checked:M||h,label:"Use groups security filter",disabled:!f||h,onChange:ot,"aria-labelledby":he,onRenderLabel:e=>t.jsx(r,{labelId:he,fieldId:ge,helpText:i.useGroupsSecurityFilter,label:e?.label})})]}),F&&t.jsx(kt,{})]})]})}Gt.displayName="Ask";export{Gt as Component};
//# sourceMappingURL=Ask-fc321fe0.js.map
